<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebUSB Example</title>
</head>
<body>
    <button id="connectButton">Connect to USB Device</button>

    <p>Device information: </p>
    <p id="dev"></p>
    <p id="name"></p>
    <p id="man"></p>
    <p id="data"></p>

    <script>
        document.getElementById('connectButton').addEventListener('click', async () => {
            try {

                let device;

                navigator.usb.requestDevice({ filters: [{ vendorId: 0x256c }] })
                .then(selectedDevice => {
                    device = selectedDevice;
                    return device.open(); // Begin a session.
                })
                .then(() => document.getElementById('dev').innerHTML = 'USB device selected: ' + device)
                .then(() => document.getElementById('name').innerHTML = 'Product name: ' + device.productName)
                .then(() => document.getElementById('man').innerHTML = 'Manufacturer: ' + device.manufacturerName)
                .then(() => device.selectConfiguration(1)) // Select configuration #1 for the device.
                .then(() => device.claimInterface(2)) // Request exclusive control over interface #2.
                .then(() => device.controlTransferOut({
                    requestType: 'class',
                    recipient: 'interface',
                    request: 0x22,
                    value: 0x01,
                    index: 0x02})) // Ready to receive data
                .then(() => device.transferIn(5, 64)) // Waiting for 64 bytes of data from endpoint #5.
                .then(result => {
                    const decoder = new TextDecoder();
                    document.getElementById('data').innerHTML = 'Received: ' + decoder.decode(result.data);
                })
                .catch(error => { console.error(error); });

            } catch (error) {
                console.error('Error selecting USB device:', error);
            }
        });
    </script>
</body>
</html>