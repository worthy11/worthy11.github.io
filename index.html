<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pen Tracker</title>
    <link rel="stylesheet" href="styles.css">
    <script src="scripts.js"></script>
</head>
<body>
    <div class="wrapper">
        <div class="widget settings">
            <div class="widget-header">Ustawienia</div>
            <div class="widget-content">
                <div class="input-field">
                    <div class="input-header" style="font-size: 15px;"><b>TYP FUNKCJI</b></div>
                    <select id="functype">
                        <option value="square">FALA SQUARE</option>
                        <option value="sine">SINUSOIDA</option>
                        <option value="parabola">PARABOLA</option>
                        <option value="linear">PROSTA</option>
                    </select>
                </div>

                <div id="domain" class="input-field">
                    <div class="input-header">Dziedzina</div>
                    <input id="domain_in" type='range' min='10' max='20' step="0.1" value="20">
                    <div id="domain_display" style="float: left;">20</div>
                </div>
                <div id="freq" class="input-field">
                    <div class="input-header">Częstotliwość</div>
                    <input id="freq_in" type='range' min='1' max='10' step="0.1" value="5">
                    <div id="freq_display" style="float: left;">5</div>
                </div>
                <div id="amp" class="input-field">
                    <div class="input-header">Amplituda</div>
                    <input id="amp_in" type='range' min='0' max='10' step="0.1" value="5">
                    <div id="amp_display" style="float: left;">5</div>
                </div>
                <div id="a" class="input-field">
                    <div class="input-header">A</div>
                    <input id="a_in" type='number'>
                </div>
                <div id="b" class="input-field">
                    <div class="input-header">B</div>
                    <input id="b_in" type='number'>
                </div>
                <div id="c" class="input-field">
                    <div class="input-header">C</div>
                    <input id="c_in" type='number'>
                </div><br/>
                
                <div class="input-field">
                    <button id="plot">SZKICUJ</button>
                </div>

                <div class="input-field">
                    <button id="start">ROZPOCZNIJ</button><br /><br />
                </div>
            </div>
        </div>

        <div class="widget plot">
            <div class="widget-header">Wykres</div>
            <div class="widget-content">
                <div class="canvas" style="position: relative; width: 800px; height: 400px;">
                    <canvas id="tracker" width="15" height="15" style="position: absolute; top: 0; left: 0;"></canvas>
                    <canvas id="canvas" width="800" height="400" style="position: absolute; top: 0; left: 0; right: 0; margin: auto;"></canvas>
                </div>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById("canvas");
        const ctx = canvas.getContext("2d");

        const tracker = document.getElementById("tracker");
        const tracker_ctx = tracker.getContext("2d");
        ctx.fillStyle = "black";
        ctx.lineWidth = 3;
        tracker_ctx.arc(7.5, 7.5, 7.5, 0, 2 * Math.PI);
        tracker_ctx.fillStyle = "black";
        tracker_ctx.fill();
        
        // PARAMS
        const unit = canvas.height / 10;
        const point_frequency = 1000;
        const tracker_speed = 0.5;
        var func_type = "square";
        var domain = 20, freq = 5, amp = 2;
        var coeff_a = 1, coeff_b = 1, coeff_c = 1;
        // ADD SAMPLING FREQUENCY
        // ADD SAMPLING TIME
        // ADD RANDOM SPEED CHANGE
        // ADD SPEED SETTING
        
        // INITIALIZE SETTINGS AND PLOT
        DisplaySettings(func_type);
        var points = GeneratePoints(func_type, domain, freq, amp);
        PlotPoints(ctx, points, domain, unit, amp);
        tracker.style.top = `${canvas.height - points[0][1] * unit - tracker.height / 2}px`;
        
        var func_type_selector = document.getElementById("functype");
        func_type_selector.addEventListener("change", function(){
            func_type = func_type_selector.value
            DisplaySettings(func_type)
        });

        var domain_setter = document.getElementById("domain_in");
        domain_setter.addEventListener("change", function(){ 
            domain = domain_setter.value;
            document.getElementById("domain_display").innerHTML = domain;
            points = GeneratePoints(func_type, domain, freq, amp, coeff_a, coeff_b, coeff_c);
            PlotPoints(ctx, points, domain, unit, amp);
        });
        
        var freq_setter = document.getElementById("freq_in");
        freq_setter.addEventListener("change", function(){
            freq = freq_setter.value;
            document.getElementById("freq_display").innerHTML = freq;
            points = GeneratePoints(func_type, domain, freq, amp, coeff_a, coeff_b, coeff_c);
            PlotPoints(ctx, points, domain, unit, amp);
        });
        
        var amp_setter = document.getElementById("amp_in");
        amp_setter.addEventListener("change", function(){
            amp = amp_setter.value;
            document.getElementById("amp_display").innerHTML = amp;
            points = GeneratePoints(func_type, domain, freq, amp, coeff_a, coeff_b, coeff_c);
            PlotPoints(ctx, points, domain, unit, amp);
        });
        
        var coeff_a_setter = document.getElementById("a_in");
        coeff_a_setter.addEventListener("change", function(){
            coeff_a = coeff_a_setter.value;
            points = GeneratePoints(func_type, domain, freq, amp, coeff_a, coeff_b, coeff_c);
            PlotPoints(ctx, points, domain, unit, amp);
        });
        
        var coeff_b_setter = document.getElementById("b_in");
        coeff_b_setter.addEventListener("change", function(){
            coeff_b = coeff_b_setter.value;
            points = GeneratePoints(func_type, domain, freq, amp, coeff_a, coeff_b, coeff_c);
            PlotPoints(ctx, points, domain, unit, amp);
        });
        
        var coeff_c_setter = document.getElementById("c_in");
        coeff_c_setter.addEventListener("change", function(){
            coeff_c = coeff_c_setter.value;
            points = GeneratePoints(func_type, domain, freq, amp, coeff_a, coeff_b, coeff_c);
            PlotPoints(ctx, points, domain, unit, amp);
        });
        
        var plot = document.getElementById("plot");
        plot.addEventListener("click", function(){
            points = GeneratePoints(func_type, domain, freq, amp, coeff_a, coeff_b, coeff_c);
            PlotPoints(ctx, points, domain, unit, amp);
        });
        
        var start = document.getElementById("start");
        start.addEventListener("click", function(){
            StartTracker(tracker, points, tracker_speed, unit);
        });
        </script>
</body>
</html>
